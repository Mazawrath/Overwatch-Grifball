settings
{
	modes
	{
		Team Deathmatch
		{
			enabled maps
			{
				Workshop Chamber
				Workshop Island
			}
		}

		General
		{
			Hero Limit: Off
			Respawn Time Scalar: 25%
		}
	}

	heroes
	{
		General
		{
			Genji
			{
				Deflect: Off
				Infinite Ultimate Duration: On
				Spawn With Ultimate Ready: On
				Swift Strike: Off
			}

			Torbjörn
			{
				Deploy Turret: Off
				No Ammunition Requirement: On
				Overload: Off
				Ultimate Ability Molten Core: Off
				Weapons Enabled: Forge Hammer Only
			}

			enabled heroes
			{
				Genji
				Torbjörn
			}
		}
	}
}

variables
{
	player:
		1: PlayerTargeted
		2: PlayerInRange
}

disabled rule("Create ball")
{
	event
	{
		Ongoing - Global;
	}

	actions
	{
		Create Effect(All Players(All Teams), Orb, White, Vector(0, 0, 0), 1, Visible To Position and Radius);
	}
}

rule("Player can only swing once")
{
	event
	{
		Ongoing - Each Player;
		All;
		All;
	}

	conditions
	{
		Is Button Held(Event Player, Primary Fire) == True;
	}

	actions
	{
		Press Button(Event Player, Primary Fire);
		Set Primary Fire Enabled(Event Player, False);
		Wait(0.500, Ignore Condition);
		Set Primary Fire Enabled(Event Player, True);
	}
}

rule("Create target particle")
{
	event
	{
		Ongoing - Each Player;
		All;
		All;
	}

	actions
	{
		Create Effect(Event Player, Bad Aura, Red, Player Variable(Event Player, PlayerTargeted), 1, Position and Radius);
	}
}

rule("Lunge towards targeted player")
{
	event
	{
		Ongoing - Each Player;
		All;
		All;
	}

	conditions
	{
		Is Button Held(Event Player, Primary Fire) == True;
		Player Variable(Event Player, PlayerInRange) == True;
	}

	actions
	{
		Apply Impulse(Event Player, Up, 6, To World, Cancel Contrary Motion);
		Apply Impulse(Event Player, Direction Towards(Position Of(Event Player), Player Variable(Event Player, PlayerTargeted)), 9,
			To World, Cancel Contrary Motion);
	}
}

rule("Get player to target")
{
	event
	{
		Ongoing - Each Player;
		All;
		All;
	}

	actions
	{
		"At least 1 player is within the players reticle"
		If(Compare(Count Of(Filtered Array(Players in View Angle(Event Player, Opposite Team Of(Team Of(Event Player)), 5), Is Alive(
			Current Array Element))), >=, 1));
			Set Player Variable(Event Player, PlayerTargeted, Position Of(First Of(Sorted Array(Filtered Array(All Living Players(
				Opposite Team Of(Team Of(Event Player))), Is In View Angle(Event Player, Position Of(Current Array Element), 5)),
				Angle Between Vectors(Facing Direction Of(Event Player), Direction Towards(Eye Position(Event Player), Eye Position(
				Current Array Element)))))));
			Set Player Variable(Event Player, PlayerInRange, True);
		Else;
			Set Player Variable(Event Player, PlayerTargeted, Vector(0, -20.000, 0));
			Set Player Variable(Event Player, PlayerInRange, False);
		End;
		Wait(0.250, Ignore Condition);
		Loop;
	}
}

rule("// DEV TOOLS")
{
	event
	{
		Ongoing - Global;
	}
}

rule("Spawn Dummies")
{
	event
	{
		Ongoing - Global;
	}

	actions
	{
		Create Dummy Bot(Hero(Torbjörn), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
		Create Dummy Bot(Hero(Genji), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
		Create Dummy Bot(Hero(Torbjörn), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
		Create Dummy Bot(Hero(Genji), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
		Create Dummy Bot(Hero(Torbjörn), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
		Create Dummy Bot(Hero(Genji), Team 2, -1.000, Vector(0, 0, 0), Vector(0, 0, 0));
	}
}